# Проектная работа "Веб-ларек"

## Описание

Проект "Веб-ларек" представляет собой интернет-магазин, ориентированный на товары для веб-разработчиков. Пользователи могут просматривать каталог товаров, добавлять товары в корзину и оформлять заказы.

## Функциональные требования

### Главная страница:

- Содержит каталог товаров.
- При нажатии на карточку товара открывается модальное окно с детальной информацией о товаре.
- При нажатии на иконку корзины открывается корзина.

### Просмотр товара:

- Показана детальная информация о товаре.
- При нажатии на кнопку «Купить» товар добавляется в корзину, если не был добавлен в корзину раньше.
- При нажатии на кнопку «Убрать» товар удаляется из корзины.

### Оформление заказа:

- **Первый шаг:**
  - Выбор способа оплаты.
  - Ввод адреса доставки.
  - Если адрес доставки не введён, появляется сообщение об ошибке.
- **Второй шаг:**
  - Ввод почты и телефона покупателя.
  - Если одно из полей не заполнено, появляется сообщение об ошибке.
  - При нажатии на кнопку оплаты появляется сообщение об успешной оплате и товары удаляются из корзины.

### Требования ко всем страницам:

- Модальные окна закрываются:
  - По клику вне модального окна.
  - По клику на иконку «Закрыть» (крестик).
- Кнопка перехода к следующему шагу становится доступна только после выполнения действий на текущей странице (выбора товара, способа оплаты, заполнения данных о покупателе).

## Стек технологий

- **HTML:** Разметка страниц.
- **SCSS:** Препроцессор CSS для написания стилей.
- **TypeScript (TS):** Язык программирования для типизации и улучшения качества кода.
- **Webpack:** Сборщик модулей для сборки проекта.

## Структура проекта

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание базовых классов

- **`EventEmitter` (из `src/components/base/events.ts`):** Обеспечивает работу событий.

  - **`on(event: string | RegExp, callback: (data: T) => void): void`:** Устанавливает обработчик (`callback`) на событие (`event`). `event` может быть строкой или регулярным выражением.
  - **`emit(event: string, data?: T): void`:** Публикует событие (`event`) с данными (`data`). Все подписчики на это событие будут уведомлены.
  - **`trigger(eventName: string, context?: Partial<T>): (data: T) => void`:** Создает коллбэк, который при вызове генерирует событие `eventName` с данными `data` и контекстом `context`.

- **`Api` (из `src/components/base/api.ts`):** Отвечает за взаимодействие с API.
  - **`baseUrl: string`:** Базовый URL API.
  - **`get(uri: string): Promise<any>`:** Выполняет GET-запрос к указанному URI (`uri`). Возвращает Promise с данными в формате JSON.
  - **`post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<any>`:** Выполняет POST-запрос к указанному URI (`uri`) с данными (`data`) и указанным HTTP-методом (`method`). Возвращает Promise с данными в формате JSON.

## Описание классов

- **`InitialPageView`:** Отображает начальную страницу приложения. Содержит список товаров, кнопку "Оформить заказ" и счетчик количества товаров в корзине.

  - **Назначение:** Предоставляет пользователю начальный интерфейс для просмотра товаров и перехода к оформлению заказа.
  - **Конструктор:** `InitialPageView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться страница.
  - **Поля:**
    - `- containerId: string` - ID контейнера страницы (string).
  - **Методы:**
    - `+ render(products: Product[]): void` - Отображает список товаров на странице.
    - `+ updateCartCounter(count: number): void` - Обновляет значение счетчика товаров в корзине.

- **`ProductModalView`:** Отображает детальную информацию о товаре в модальном окне. Содержит полное описание, цену, изображение и кнопки "Купить" и "Убрать из корзины".

  - **Назначение:** Предоставляет подробную информацию о товаре в модальном окне.
  - **Конструктор:** `ProductModalView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться модальное окно.
  - **Поля:**
    - `- containerId: string` - ID контейнера модального окна (string).
  - **Методы:**
    - `+ render(product: Product): void` - Отображает информацию о товаре в модальном окне.
    - `+ close(): void` - Закрывает модальное окно.

- **`CartView`:** Отображает содержимое корзины (список товаров, количество, общая стоимость). Позволяет пользователю перейти к оформлению заказа.

  - **Назначение:** Отображает товары, добавленные в корзину.
  - **Конструктор:** `CartView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться корзина.
  - **Поля:**
    - `- containerId: string` - ID контейнера корзины (string).
  - **Методы:**
    - `+ render(cartItems: CartItem[]): void` - Отображает список товаров в корзине.
    - `+ updateTotal(total: number): void` - Обновляет общую стоимость товаров в корзине.

- **`CartItemView`:** Отображает отдельный товар в корзине. Содержит информацию о товаре, количество и кнопку удаления.

  - **Назначение:** Отображает один товар в корзине и позволяет изменить его количество или удалить из корзины.
  - **Конструктор:** `CartItemView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться товар.
  - **Поля:**
    - `- containerId: string` - ID контейнера элемента корзины (string).
  - **Методы:**
    - `+ render(cartItem: CartItem): void` - Отображает информацию о товаре в корзине.

- **`OrderDeliveryView`:** Отображает форму для ввода адреса доставки.

  - **Назначение:** Собирает информацию об адресе доставки от пользователя.
  - **Конструктор:** `OrderDeliveryView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться форма.
  - **Поля:**
    - `- containerId: string` - ID контейнера формы доставки (string).
  - **Методы:**
    - `+ render(): void` - Отображает форму для ввода адреса доставки.
    - `+ getFormData(): DeliveryData` - Возвращает данные, введенные пользователем в форме.

- **`OrderPaymentView`:** Отображает форму для выбора способа оплаты.

  - **Назначение:** Предоставляет пользователю возможность выбора способа оплаты.
  - **Конструктор:** `OrderPaymentView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться форма.
  - **Поля:**
    - `- containerId: string` - ID контейнера формы оплаты (string).
  - **Методы:**
    - `+ render(): void` - Отображает форму для выбора способа оплаты.
    - `+ getSelectedPaymentMethod(): string` - Возвращает выбранный пользователем способ оплаты.

- **`SuccessOrderView`:** Отображает сообщение об успешном оформлении заказа.

  - **Назначение:** Информирует пользователя об успешном создании заказа.
  - **Конструктор:** `SuccessOrderView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться сообщение.
  - **Поля:**
    - `- containerId: string` - ID контейнера сообщения об успехе (string).
  - **Методы:**
    - `+ render(orderId: string): void` - Отображает сообщение об успешном оформлении заказа, включая ID заказа.

- **`ModalView`:** Базовое модальное окно. Содержит кнопку закрытия и контейнер, в котором отображается содержимое.

  - **Назначение:** Предоставляет базовую структуру модального окна для отображения различных представлений.
  - **Конструктор:** `ModalView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться модальное окно.
  - **Поля:**
    - `- containerId: string` - ID контейнера модального окна (string).
  - **Методы:**
    - `+ open(content: HTMLElement): void` - Открывает модальное окно и отображает переданный контент.
    - `+ close(): void` - Закрывает модальное окно.

- **`Product`:** Представляет информацию о товаре.

  - **Назначение:** Хранит данные о товаре.
  - **Конструктор:** `Product(id: string, name: string, description: string, price: number, imageUrl: string)` - Создает экземпляр товара.
  - **Поля:**
    - `- id: string` - Уникальный идентификатор товара.
    - `- name: string` - Название товара.
    - `- description: string` - Описание товара.
    - `- price: number` - Цена товара.
    - `- imageUrl: string` - URL изображения товара.
  - **Методы:** Нет.

- **`CartItem`:** Представляет товар в корзине.

  - **Назначение:** Хранит информацию о товаре и его количестве в корзине.
  - **Конструктор:** `CartItem(product: Product, quantity: number)` - Создает экземпляр товара в корзине.
  - **Поля:**
    - `- product: Product` - Товар.
    - `- quantity: number` - Количество товара в корзине.
  - **Методы:** Нет.

- **`DeliveryData`:** Представляет информацию об адресе доставки.

  - **Назначение:** Хранит данные об адресе доставки.
  - **Конструктор:** `DeliveryData(address: string, city: string, zipCode: string)` - Создает экземпляр адреса доставки.
  - **Поля:**
    - `- address: string` - Адрес доставки.
    - `- city: string` - Город доставки.
    - `- zipCode: string` - Почтовый индекс.
  - **Методы:** Нет.

- **`EventEmitter`:** Обеспечивает работу событий.
  - **Назначение:** Позволяет устанавливать и снимать слушателей событий, а также вызывать слушателей при возникновении события.
  - **Конструктор:** `EventEmitter()` - Создает экземпляр EventEmitter.
  - **Поля:** Нет.
  - **Методы:**
    - `+ on(event: string, listener: Function): void` - Устанавливает слушателя на событие.
    - `+ off(event: string, listener: Function): void` - Снимает слушателя с события.
    - `+ emit(event: string, ...args: any[]): void` - Вызывает слушателей события.

## Описание компонентов (View)

- **`InitialPageView`:** Отображает начальную страницу приложения. Содержит список товаров, кнопку "Оформить заказ" и счетчик количества товаров в корзине.

  - **Назначение:** Предоставляет пользователю начальный интерфейс для просмотра товаров и перехода к оформлению заказа.
  - **Конструктор:** Не имеет параметров.
  - **Поля:** Отсутствуют.
  - **Методы:**
    - `render(products: Product[]): void` - Отображает список товаров на странице.
    - `updateCartCounter(count: number): void` - Обновляет значение счетчика товаров в корзине.

- **`ProductModalView`:** Отображает детальную информацию о товаре в модальном окне. Содержит полное описание, цену, изображение и кнопки "Купить" и "Убрать из корзины". Позволяет пользователю просмотреть подробную информацию о товаре и добавить/удалить его из корзины.

  - **Назначение:** Предоставляет подробную информацию о товаре в модальном окне.
  - **Конструктор:** `ProductModalView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться модальное окно.
  - **Поля:**
    - `containerId: string` - ID контейнера модального окна.
  - **Методы:**
    - `render(product: Product): void` - Отображает информацию о товаре в модальном окне.
    - `close(): void` - Закрывает модальное окно.

- **`CartView`:** Отображает содержимое корзины (список товаров, количество, общая стоимость). Позволяет пользователю перейти к оформлению заказа.

  - **Назначение:** Отображает товары, добавленные в корзину.
  - **Конструктор:** `CartView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться корзина.
  - **Поля:**
    - `containerId: string` - ID контейнера корзины.
  - **Методы:**
    - `render(cartItems: CartItem[]): void` - Отображает список товаров в корзине.
    - `updateTotal(total: number): void` - Обновляет общую стоимость товаров в корзине.

- **`CartItemView`:** Отображает отдельный товар в корзине. Содержит информацию о товаре, количество и кнопку удаления.

  - **Назначение:** Отображает один товар в корзине и позволяет изменить его количество или удалить из корзины.
  - **Конструктор:** `CartItemView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться товар.
  - **Поля:**
    - `containerId: string` - ID контейнера элемента корзины.
  - **Методы:**
    - `render(cartItem: CartItem): void` - Отображает информацию о товаре в корзине.

- **`OrderDeliveryView`:** Отображает форму для ввода адреса доставки.

  - **Назначение:** Собирает информацию об адресе доставки от пользователя.
  - **Конструктор:** `OrderDeliveryView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться форма.
  - **Поля:**
    - `containerId: string` - ID контейнера формы доставки.
  - **Методы:**
    - `render(): void` - Отображает форму для ввода адреса доставки.
    - `getFormData(): DeliveryData` - Возвращает данные, введенные пользователем в форме.

- **`OrderPaymentView`:** Отображает форму для выбора способа оплаты.

  - **Назначение:** Предоставляет пользователю возможность выбора способа оплаты.
  - **Конструктор:** `OrderPaymentView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться форма.
  - **Поля:**
    - `containerId: string` - ID контейнера формы оплаты.
  - **Методы:**
    - `render(): void` - Отображает форму для выбора способа оплаты.
    - `getSelectedPaymentMethod(): string` - Возвращает выбранный пользователем способ оплаты.

- **`SuccessOrderView`:** Отображает сообщение об успешном оформлении заказа.

  - **Назначение:** Информирует пользователя об успешном создании заказа.
  - **Конструктор:** `SuccessOrderView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться сообщение.
  - **Поля:**
    - `containerId: string` - ID контейнера сообщения об успехе.
  - **Методы:**
    - `render(orderId: string): void` - Отображает сообщение об успешном оформлении заказа, включая ID заказа.

- **`ModalView`:** Базовое модальное окно. Содержит кнопку закрытия и контейнер, в котором отображается содержимое.
  - **Назначение:** Предоставляет базовую структуру модального окна для отображения различных представлений.
  - **Конструктор:** `ModalView(containerId: string)` - Принимает ID контейнера, в котором будет отображаться модальное окно.
  - **Поля:**
    - `containerId: string` - ID контейнера модального окна.
  - **Методы:**
    - `open(content: HTMLElement): void` - Открывает модальное окно и отображает переданный контент.
    - `close(): void` - Закрывает модальное окно.

## Описание моделей

- **`ProductModel`:** Отвечает за получение и обработку данных о товарах. Использует `Api` для получения данных с сервера.
  - **Задача:** Предоставляет данные о товарах для компонентов отображения.
  - **Структура:** Содержит методы для получения списка товаров (`getProducts`) и информации о конкретном товаре (`getProductById`).
- **`CartModel`:** Отвечает за управление корзиной (добавление, удаление, изменение количества товаров). Хранит информацию о товарах в корзине.
  - **Задача:** Управление состоянием корзины.
  - **Структура:** Содержит методы для добавления товара в корзину (`addToCart`), удаления товара из корзины (`removeFromCart`), изменения количества товара (`updateQuantity`).
- **`OrderModel`:** Отвечает за оформление заказа (отправка данных на сервер, обработка ошибок).
  - **Задача:** Отправка данных заказа на сервер и обработка ответа.
  - **Структура:** Содержит метод для отправки данных заказа (`submitOrder`).

## Данные (типы определены в `src/types/index.ts`)

- `Product`
- `CartItem`
- `Order`

## Архитектура

В проекте используется вариант MV\* паттерна, где View (компоненты) взаимодействуют с Model (модели данных) через брокер событий (`EventEmitter`).

## Процессы

- **Добавление товара в корзину:**

  1.  Пользователь кликает кнопку "Купить" в `ProductCard` или `ProductModalView`.
  2.  `ProductCard` или `ProductModalView` публикует событие `addToCart` (через `EventEmitter`) с `productId`.
  3.  `CartModel` получает событие `addToCart`, добавляет товар в корзину (или увеличивает количество, если товар уже в корзине) и публикует событие `cartUpdated`.
  4.  `CartView` получает событие `cartUpdated` и обновляет отображение.

- **Просмотр детальной информации о товаре:**

  1.  Пользователь кликает на карточку товара.
  2.  `ProductCard` публикует событие `productSelected` с `productId`.
  3.  `ProductModalView` получает событие `productSelected`, запрашивает информацию о товаре у `ProductModel` (через метод `getProductById()`), и отображает детальную информацию в модальном окне.

- **Оформление заказа:**
  1.  Пользователь заполняет данные в `OrderView` (адрес, способ оплаты, контактные данные) и нажимает кнопку "Оформить заказ".
  2.  `OrderView` публикует событие `submitOrder` с данными заказа.
  3.  `OrderModel` получает событие `submitOrder`, отправляет данные на сервер через `Api`, и публикует событие `orderSuccess` или `orderError` в зависимости от результата.

## UML-схема (опционально)

![UML-схема](/src/images/Диаграмма%20без%20названия.drawio%20(3).png)
